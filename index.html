<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Movie Explorer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: #0b0b0b;
    color: #fff;
  }

  header {
    padding: 1rem;
    text-align: center;
    font-size: 1.6rem;
    background: #111;
  }

  section {
    padding: 1rem;
  }

  h2 {
    margin-bottom: 0.5rem;
  }

  .movies {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 1rem;
  }

  .movie {
    cursor: pointer;
    transition: transform 0.2s;
  }

  .movie:hover { transform: scale(1.05); }

  img {
    width: 100%;
    border-radius: 10px;
  }

  .title {
    font-size: 0.9rem;
    margin-top: 0.3rem;
  }

  .rating {
    color: #f5c518;
    font-size: 0.8rem;
  }

  .genre-label {
    font-size: 0.75rem;
    opacity: 0.7;
  }

  .modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }

  .modal-content {
    background: #111;
    max-width: 600px;
    width: 100%;
    padding: 1rem;
    border-radius: 12px;
  }

  .close {
    text-align: right;
    cursor: pointer;
    font-size: 1.2rem;
  }
</style>
</head>

<body>

<header>üé¨ Movie Explorer</header>

<section>
  <h2>üé≤ Random Movie by Genre</h2>
  <div class="movies" id="random-genres"></div>
</section>

<section>
  <h2>üî• Popular Movies</h2>
  <div class="movies" id="popular"></div>
</section>

<section>
  <h2>‚è≥ Upcoming Movies</h2>
  <div class="movies" id="upcoming"></div>
</section>

<div class="modal" id="modal">
  <div class="modal-content">
    <div class="close" onclick="closeModal()">‚úñ</div>
    <h2 id="modalTitle"></h2>
    <p id="modalOverview"></p>
  </div>
</div>

<script>
  const IMG = "https://image.tmdb.org/t/p/w500";
  const TMDB_TOKEN = "__TMDB_TOKEN__";

  const headers = {
    accept: "application/json",
    Authorization: `Bearer ${TMDB_TOKEN}`
  };

  const modal = document.getElementById("modal");
  const modalTitle = document.getElementById("modalTitle");
  const modalOverview = document.getElementById("modalOverview");

  function fetchJSON(url) {
    return fetch(url, { headers }).then(r => r.json());
  }

  function renderMovie(el, movie, label = "") {
    el.innerHTML = `
      <img loading="lazy" src="${IMG + movie.poster_path}">
      <div class="title">${movie.title}</div>
      <div class="rating">‚≠ê ${movie.vote_average}</div>
      ${label ? `<div class="genre-label">${label}</div>` : ""}
    `;
    el.onclick = () => openModal(movie);
  }

  function openModal(movie) {
    modalTitle.textContent = movie.title;
    modalOverview.textContent = movie.overview || "No description available.";
    modal.style.display = "flex";
  }

  function closeModal() {
    modal.style.display = "none";
  }

  function renderList(containerId, movies, limit = 12) {
    const container = document.getElementById(containerId);
    movies.slice(0, limit).forEach(movie => {
      const el = document.createElement("div");
      el.className = "movie";
      renderMovie(el, movie);
      container.appendChild(el);
    });
  }

  fetchJSON("https://api.themoviedb.org/3/movie/popular")
    .then(d => renderList("popular", d.results));

  fetchJSON("https://api.themoviedb.org/3/movie/upcoming")
    .then(d => renderList("upcoming", d.results));

  fetchJSON("https://api.themoviedb.org/3/genre/movie/list")
    .then(d => {
      const container = document.getElementById("random-genres");

      d.genres.forEach(genre => {
        fetchJSON(
          `https://api.themoviedb.org/3/discover/movie?with_genres=${genre.id}&sort_by=popularity.desc`
        ).then(res => {
          if (!res.results.length) return;

          const movie = res.results[Math.floor(Math.random() * res.results.length)];
          const el = document.createElement("div");
          el.className = "movie";
          renderMovie(el, movie, genre.name);
          container.appendChild(el);
        });
      });
    });
</script>

</body>
</html>
